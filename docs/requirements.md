# 视频编辑器项目需求文档

## 1. 项目概述

### 1.1 项目背景
开发一个基于Web的视频编辑器，支持移动端（Android/iOS）访问，让用户能够方便地进行视频编辑和添加各类水印效果。

### 1.2 技术选型
- 前端：React + TypeScript
- 后端：Node.js (v16.20)
- 数据库：SQLite（文件型数据库，无需安装）
- 部署环境：CentOS 7.9

## 2. 功能需求

### 2.1 用户端功能

#### 2.1.1 视频上传
- 支持本地视频文件上传
- 支持视频预览
- 显示上传进度
- 支持常见视频格式（MP4、MOV等）

#### 2.1.2 视频编辑功能
- 添加文字水印
  * 自定义文字内容
  * 调整文字大小、颜色、位置
  * 选择字体样式
  
- 添加图片水印
  * 上传自定义图片
  * 调整图片大小、位置
  * 设置透明度
  
- 添加视频水印（画中画）
  * 支持第二个视频作为水印
  * 调整画中画位置和大小
  * 设置画中画播放时间段
  
- 视频特效
  * 添加转场动画
  * 添加滤镜效果
  * 调整视频速度
  
#### 2.1.3 模板系统
- 浏览模板列表
- 预览模板效果
- 一键应用模板
- 收藏喜欢的模板
- 为模板点赞
- 按分类查看模板

### 2.2 管理端功能

#### 2.2.1 用户管理
- 查看用户列表
- 查看用户基本信息
- 禁用/启用用户
- 查看用户使用记录

#### 2.2.2 模板管理
- 创建新模板
- 编辑现有模板
- 删除模板
- 模板分类管理
- 查看模板使用统计

## 3. 非功能需求

### 3.1 性能需求
- 页面加载时间：首屏加载 < 3秒
- 视频处理时间：视频编辑操作响应 < 1秒
- 并发用户：支持1000人同时在线编辑

### 3.2 安全需求
- 基于Session的账号密码认证
- 文件上传限制
- 防止XSS攻击
- 数据加密传输

### 3.3 兼容性要求
- 支持主流移动浏览器：Safari、Chrome
- 支持iOS 11+和Android 7.0+系统
- 响应式设计，适配不同屏幕尺寸

### 3.4 用户体验
- 简洁直观的操作界面
- 清晰的视频编辑流程引导
- 实时预览编辑效果
- 操作步骤可撤销/重做

## 4. 技术架构

### 4.1 前端架构
- React + TypeScript
- Tailwind CSS用于样式开发
- FFmpeg.wasm处理视频
- Redux管理状态
- Axios处理API请求

### 4.2 后端架构
- Express.js框架
- SQLite数据库
- Express-session处理用户会话
- Multer处理文件上传
- FFmpeg处理视频

### 4.3 数据库设计（初步）
- users（用户表）
- templates（模板表）
- favorites（收藏表）
- likes（点赞表）
- videos（视频记录表）

## 5. 部署方案
- 使用PM2进行Node.js应用程序管理
- Nginx作为反向代理服务器
- 前端静态文件直接部署在服务器
- 文件存储使用服务器本地存储
- 使用定时任务进行日志清理和数据备份

### 5.1 具体部署步骤
1. 安装必要环境
   - Node.js v16.20
   - FFmpeg
   - Nginx
   - PM2

2. 项目部署
   - 前端打包后放置在 /var/www/html 目录
   - 后端代码部署在 /opt/videoeditor 目录
   - 数据库文件存放在 /opt/videoeditor/data 目录
   - 上传的视频文件存放在 /opt/videoeditor/uploads 目录

3. 运行维护
   - 使用PM2启动后端服务
   - 配置Nginx反向代理
   - 设置日志轮转
   - 配置定时备份

## 6. 项目里程碑

### 第一阶段（基础功能）
- 完成用户注册登录
- 实现视频上传和基础编辑
- 完成基础管理后台

### 第二阶段（核心功能）
- 实现各类水印功能
- 完成模板系统
- 实现视频特效功能

### 第三阶段（优化完善）
- 优化用户体验
- 完善模板管理
- 性能优化和bug修复

## 7. 风险评估
1. 视频处理性能可能不足
2. 移动端兼容性问题
3. 服务器存储容量限制
4. 并发处理能力要求高

## 8. 注意事项
1. 注重移动端操作体验
2. 控制视频处理时间
3. 注意数据安全性
4. 考虑网络状况不佳情况
5. 做好容错处理
6. 定期备份SQLite数据库文件
7. 监控服务器磁盘空间使用情况
8. 建立日志记录机制便于问题排查 